{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Neerush Buchi\\\\Desktop\\\\Neerush Folder\\\\HMS\\\\frontend\\\\src\\\\pages\\\\BookAppointment.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport api from '../services/api';\nimport PaymentForm from './components/PaymentForm';\nimport Invoice from './components/Invoice';\n\n// sensible defaults so the UI works even if the backend endpoint is empty/unavailable\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DEFAULT_DEPARTMENTS = ['General Medicine', 'Cardiology', 'Orthopedics', 'Neurology', 'Pediatrics', 'Dermatology', 'ENT', 'Gynecology'];\nconst BookAppointment = () => {\n  _s();\n  var _selectedDoctor$avail, _selectedDoctor$avail2;\n  const {\n    user\n  } = useAuth();\n  const navigate = useNavigate();\n  const [formData, setFormData] = useState({\n    department: '',\n    doctorId: '',\n    date: '',\n    time: '',\n    purpose: '',\n    symptoms: ''\n  });\n  const [departments, setDepartments] = useState(DEFAULT_DEPARTMENTS);\n  const [doctors, setDoctors] = useState([]);\n  const [availableSlots, setAvailableSlots] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [step, setStep] = useState(1);\n  const [selectedDoctor, setSelectedDoctor] = useState(null);\n  const [showPayment, setShowPayment] = useState(false);\n  const [appointmentId, setAppointmentId] = useState(null);\n  const [billId, setBillId] = useState(null);\n  const [showInvoice, setShowInvoice] = useState(false);\n  useEffect(() => {\n    if (!user) {\n      navigate('/login');\n      return;\n    }\n    fetchDepartments();\n  }, [user, navigate]);\n  const fetchDepartments = async () => {\n    try {\n      var _response$data, _response$data$data;\n      // Fetch from the departments collection endpoint\n      const response = await api.get('/departments');\n      const returned = response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : (_response$data$data = _response$data.data) === null || _response$data$data === void 0 ? void 0 : _response$data$data.departments;\n      setDepartments(Array.isArray(returned) && returned.length > 0 ? returned.map(d => d.name) : DEFAULT_DEPARTMENTS);\n    } catch (error) {\n      console.error('Error fetching departments:', error);\n      // keep fallback so UI still works\n      setDepartments(DEFAULT_DEPARTMENTS);\n    }\n  };\n  const fetchDoctors = async department => {\n    try {\n      const response = await api.get(`/appointments/doctors/${department}`);\n      setDoctors(response.data.data.doctors);\n    } catch (error) {\n      console.error('Error fetching doctors:', error);\n      alert('Error loading doctors');\n    }\n  };\n  const fetchAvailableSlots = async (doctorId, date) => {\n    try {\n      const response = await api.get(`/appointments/available-slots/${doctorId}?date=${date}`);\n      setAvailableSlots(response.data.data.availableSlots);\n    } catch (error) {\n      console.error('Error fetching available slots:', error);\n      alert('Error loading available time slots');\n    }\n  };\n  const handleDepartmentChange = e => {\n    const department = e.target.value;\n    setFormData({\n      ...formData,\n      department,\n      doctorId: '',\n      date: '',\n      time: ''\n    });\n    setDoctors([]);\n    setAvailableSlots([]);\n    setSelectedDoctor(null);\n    if (department) {\n      fetchDoctors(department);\n      setStep(2);\n    } else {\n      setStep(1);\n    }\n  };\n  const handleDoctorChange = e => {\n    const doctorId = e.target.value;\n    const doctor = doctors.find(doc => doc._id === doctorId);\n    setFormData({\n      ...formData,\n      doctorId,\n      date: '',\n      time: ''\n    });\n    setAvailableSlots([]);\n    setSelectedDoctor(doctor);\n    if (doctorId) {\n      setStep(3);\n    } else {\n      setStep(2);\n    }\n  };\n  const handleDateChange = e => {\n    const date = e.target.value;\n    setFormData({\n      ...formData,\n      date,\n      time: ''\n    });\n    setAvailableSlots([]);\n    if (date && formData.doctorId) {\n      fetchAvailableSlots(formData.doctorId, date);\n      setStep(4);\n    }\n  };\n  const handleTimeSelect = time => {\n    setFormData({\n      ...formData,\n      time\n    });\n    setStep(5);\n  };\n  const handleInputChange = e => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!formData.doctorId || !formData.date || !formData.time || !formData.purpose) {\n      alert('Please fill in all required fields');\n      return;\n    }\n    setLoading(true);\n    try {\n      const response = await api.post('/appointments', formData);\n      if (response.data.status === 'success') {\n        setAppointmentId(response.data.data.appointment._id);\n        setShowPayment(true);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('Error booking appointment:', error);\n      alert(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || 'Error booking appointment');\n    } finally {\n      setLoading(false);\n    }\n  };\n  const handlePaymentComplete = async paymentDetails => {\n    try {\n      // Get the patient ID first\n      const patientResponse = await api.get('/patients/me');\n      const patientId = patientResponse.data.data.patient._id;\n\n      // First create the bill\n      const billingResponse = await api.post('/billing', {\n        appointmentId,\n        patient: patientId,\n        // Changed from patientId to patient to match model\n        doctorId: formData.doctorId,\n        amount: selectedDoctor.consultationFee,\n        paymentMode: paymentDetails.method.toUpperCase(),\n        paymentStatus: 'Paid',\n        paymentDetails: paymentDetails.details\n      });\n      if (billingResponse.data.status === 'success') {\n        // Then update appointment status\n        await api.patch(`/appointments/${appointmentId}`, {\n          status: 'Confirmed'\n        });\n        setBillId(billingResponse.data.data.bill._id);\n        setShowPayment(false);\n        setShowInvoice(true);\n      }\n    } catch (error) {\n      var _error$response2;\n      console.error('Error processing payment:', error);\n      if (((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.status) === 404) {\n        alert('Could not find the appointment. Please try booking again.');\n      } else {\n        alert('Error processing payment. Please try again.');\n      }\n      setShowPayment(false); // Close payment form on error\n    }\n  };\n  const handleViewInvoice = () => {\n    setShowInvoice(true);\n  };\n  const handleDownloadInvoice = async () => {\n    try {\n      const response = await api.get(`/billing/${billId}`);\n      const bill = response.data.data.bill;\n      // Generate PDF invoice using the bill data\n      // You can implement the PDF generation logic here\n    } catch (error) {\n      console.error('Error downloading invoice:', error);\n      alert('Error downloading invoice. Please try again.');\n    }\n  };\n  const handlePaymentSuccess = () => {\n    alert('Payment successful! You can view or download your invoice.');\n    navigate('/patient-dashboard');\n  };\n  const getMinDate = () => {\n    const today = new Date();\n    return today.toISOString().split('T')[0];\n  };\n  const getMaxDate = () => {\n    const maxDate = new Date();\n    maxDate.setMonth(maxDate.getMonth() + 2); // 2 months in advance\n    return maxDate.toISOString().split('T')[0];\n  };\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"auth-required\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: \"Authentication Required\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Please log in to book an appointment.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn\",\n          onClick: () => navigate('/login'),\n          children: \"Go to Login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 7\n    }, this);\n  }\n  const styles = {\n    overlay: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      right: 0,\n      bottom: 0,\n      backgroundColor: 'rgba(0, 0, 0, 0.7)',\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      zIndex: 1000\n    },\n    modal: {\n      backgroundColor: '#fff',\n      padding: '2rem',\n      borderRadius: '8px',\n      maxWidth: '600px',\n      width: '90%',\n      maxHeight: '90vh',\n      overflowY: 'auto'\n    },\n    invoiceActions: {\n      display: 'flex',\n      gap: '1rem',\n      marginBottom: '1rem',\n      justifyContent: 'flex-end'\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"booking-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          children: [/*#__PURE__*/_jsxDEV(\"i\", {\n            className: \"fas fa-calendar-plus\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this), \" Book Appointment\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"progress-steps\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: `step ${step >= 1 ? 'active' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Department\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 306,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `step ${step >= 2 ? 'active' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"2\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Doctor\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `step ${step >= 3 ? 'active' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"3\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 313,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Date\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 314,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `step ${step >= 4 ? 'active' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"4\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Time\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `step ${step >= 5 ? 'active' : ''}`,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"5\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Details\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        className: \"appointment-form\",\n        children: [step >= 1 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Select Department\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"department\",\n              children: \"Medical Department *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 332,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"department\",\n              name: \"department\",\n              value: formData.department,\n              onChange: handleDepartmentChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Choose a department\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 19\n              }, this), departments.map(dept => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: dept,\n                children: dept\n              }, dept, false, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 13\n        }, this), step >= 2 && doctors.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Select Doctor\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"doctor\",\n              children: \"Available Doctors *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"doctor\",\n              name: \"doctorId\",\n              value: formData.doctorId,\n              onChange: handleDoctorChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Choose a doctor\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 364,\n                columnNumber: 19\n              }, this), doctors.map(doctor => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: doctor._id,\n                children: [doctor.name, \" - \", doctor.specialization, \" (\\u20B9\", doctor.consultationFee, \")\"]\n              }, doctor._id, true, {\n                fileName: _jsxFileName,\n                lineNumber: 366,\n                columnNumber: 21\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 357,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 355,\n            columnNumber: 15\n          }, this), selectedDoctor && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"doctor-info\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Doctor Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 22\n              }, this), \" \", selectedDoctor.name]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 376,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Specialization:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 377,\n                columnNumber: 22\n              }, this), \" \", selectedDoctor.specialization]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 377,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Department:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 378,\n                columnNumber: 22\n              }, this), \" \", selectedDoctor.department]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 378,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Consultation Fee:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 379,\n                columnNumber: 22\n              }, this), \" \\u20B9\", selectedDoctor.consultationFee]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Availability:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 22\n              }, this), \" \", (_selectedDoctor$avail = selectedDoctor.availability) === null || _selectedDoctor$avail === void 0 ? void 0 : (_selectedDoctor$avail2 = _selectedDoctor$avail.days) === null || _selectedDoctor$avail2 === void 0 ? void 0 : _selectedDoctor$avail2.join(', ')]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 380,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }, this), step >= 3 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Select Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"date\",\n              children: \"Appointment Date *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"date\",\n              id: \"date\",\n              name: \"date\",\n              value: formData.date,\n              onChange: handleDateChange,\n              min: getMinDate(),\n              max: getMaxDate(),\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 392,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 390,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 388,\n          columnNumber: 13\n        }, this), step >= 4 && availableSlots.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Select Time Slot\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 409,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Available Time Slots *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 411,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"time-slots\",\n              children: availableSlots.map((slot, index) => /*#__PURE__*/_jsxDEV(\"button\", {\n                type: \"button\",\n                className: `time-slot ${formData.time === slot.time ? 'selected' : ''} ${!slot.available ? 'disabled' : ''}`,\n                onClick: () => slot.available && handleTimeSelect(slot.time),\n                disabled: !slot.available,\n                children: [slot.time, !slot.available && /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"slot-status\",\n                  children: \"Booked\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 424,\n                  columnNumber: 43\n                }, this)]\n              }, index, true, {\n                fileName: _jsxFileName,\n                lineNumber: 414,\n                columnNumber: 21\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 412,\n              columnNumber: 17\n            }, this), formData.time && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"selected-time\",\n              children: [\"Selected time: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: formData.time\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 430,\n                columnNumber: 36\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 429,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 410,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 408,\n          columnNumber: 13\n        }, this), step >= 5 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Appointment Details\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 440,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"purpose\",\n              children: \"Purpose of Visit *\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 443,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n              id: \"purpose\",\n              name: \"purpose\",\n              value: formData.purpose,\n              onChange: handleInputChange,\n              required: true,\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"Select purpose\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 451,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Consultation\",\n                children: \"General Consultation\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 452,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Follow-up\",\n                children: \"Follow-up Visit\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Checkup\",\n                children: \"Routine Checkup\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 454,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Emergency\",\n                children: \"Emergency\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 455,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Test Results\",\n                children: \"Test Results Discussion\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 456,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"Other\",\n                children: \"Other\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 444,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 442,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"form-group\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"symptoms\",\n              children: \"Symptoms or Additional Information\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 462,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n              id: \"symptoms\",\n              name: \"symptoms\",\n              value: formData.symptoms,\n              onChange: handleInputChange,\n              rows: \"4\",\n              placeholder: \"Describe your symptoms or any additional information...\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 461,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"appointment-summary\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Appointment Summary\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"summary-details\",\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Department:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 476,\n                  columnNumber: 22\n                }, this), \" \", formData.department]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Doctor:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 477,\n                  columnNumber: 22\n                }, this), \" \", selectedDoctor === null || selectedDoctor === void 0 ? void 0 : selectedDoctor.name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 477,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Date:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 478,\n                  columnNumber: 22\n                }, this), \" \", new Date(formData.date).toLocaleDateString()]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 478,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Time:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 479,\n                  columnNumber: 22\n                }, this), \" \", formData.time]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 479,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Purpose:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 480,\n                  columnNumber: 22\n                }, this), \" \", formData.purpose]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 480,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Consultation Fee:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 481,\n                  columnNumber: 22\n                }, this), \" \\u20B9\", selectedDoctor === null || selectedDoctor === void 0 ? void 0 : selectedDoctor.consultationFee]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 481,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 475,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"btn btn-primary submit-btn\",\n            disabled: loading,\n            children: loading ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-spinner fa-spin\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 21\n              }, this), \" Booking Appointment...\"]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"i\", {\n                className: \"fas fa-arrow-right\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 496,\n                columnNumber: 21\n              }, this), \" Proceed to Payment\"]\n            }, void 0, true)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 485,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this), step < 5 && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-navigation\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"step-guide\",\n            children: [step === 1 && 'Select a medical department to continue', step === 2 && 'Choose a doctor from the available specialists', step === 3 && 'Select your preferred appointment date', step === 4 && 'Pick an available time slot']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }, this), showPayment && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.overlay,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.modal,\n        children: /*#__PURE__*/_jsxDEV(PaymentForm, {\n          amount: selectedDoctor === null || selectedDoctor === void 0 ? void 0 : selectedDoctor.consultationFee,\n          onPaymentComplete: handlePaymentComplete,\n          onCancel: () => setShowPayment(false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 519,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 518,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 517,\n      columnNumber: 9\n    }, this), showInvoice && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.overlay,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.modal,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.invoiceActions,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleViewInvoice,\n            className: \"btn btn-primary\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-eye\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 533,\n              columnNumber: 17\n            }, this), \" View Invoice\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 532,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleDownloadInvoice,\n            className: \"btn btn-secondary\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-download\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 536,\n              columnNumber: 17\n            }, this), \" Download Invoice\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 535,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handlePaymentSuccess,\n            className: \"btn btn-success\",\n            children: [/*#__PURE__*/_jsxDEV(\"i\", {\n              className: \"fas fa-check\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 539,\n              columnNumber: 17\n            }, this), \" Done\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 538,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Invoice, {\n          billId: billId,\n          appointment: {\n            doctor: selectedDoctor,\n            date: formData.date,\n            time: formData.time,\n            department: formData.department,\n            purpose: formData.purpose\n          },\n          patient: user,\n          amount: selectedDoctor === null || selectedDoctor === void 0 ? void 0 : selectedDoctor.consultationFee\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 542,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 529,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 299,\n    columnNumber: 5\n  }, this);\n};\n_s(BookAppointment, \"okhU8th0DcjPd0fjupZhf4Ctaqw=\", false, function () {\n  return [useAuth, useNavigate];\n});\n_c = BookAppointment;\nexport default BookAppointment;\nvar _c;\n$RefreshReg$(_c, \"BookAppointment\");","map":{"version":3,"names":["React","useState","useEffect","useAuth","useNavigate","api","PaymentForm","Invoice","jsxDEV","_jsxDEV","Fragment","_Fragment","DEFAULT_DEPARTMENTS","BookAppointment","_s","_selectedDoctor$avail","_selectedDoctor$avail2","user","navigate","formData","setFormData","department","doctorId","date","time","purpose","symptoms","departments","setDepartments","doctors","setDoctors","availableSlots","setAvailableSlots","loading","setLoading","step","setStep","selectedDoctor","setSelectedDoctor","showPayment","setShowPayment","appointmentId","setAppointmentId","billId","setBillId","showInvoice","setShowInvoice","fetchDepartments","_response$data","_response$data$data","response","get","returned","data","Array","isArray","length","map","d","name","error","console","fetchDoctors","alert","fetchAvailableSlots","handleDepartmentChange","e","target","value","handleDoctorChange","doctor","find","doc","_id","handleDateChange","handleTimeSelect","handleInputChange","handleSubmit","preventDefault","post","status","appointment","_error$response","_error$response$data","message","handlePaymentComplete","paymentDetails","patientResponse","patientId","patient","billingResponse","amount","consultationFee","paymentMode","method","toUpperCase","paymentStatus","details","patch","bill","_error$response2","handleViewInvoice","handleDownloadInvoice","handlePaymentSuccess","getMinDate","today","Date","toISOString","split","getMaxDate","maxDate","setMonth","getMonth","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","styles","overlay","position","top","left","right","bottom","backgroundColor","display","justifyContent","alignItems","zIndex","modal","padding","borderRadius","maxWidth","width","maxHeight","overflowY","invoiceActions","gap","marginBottom","onSubmit","htmlFor","id","onChange","required","dept","specialization","availability","days","join","type","min","max","slot","index","available","disabled","rows","placeholder","toLocaleDateString","style","onPaymentComplete","onCancel","_c","$RefreshReg$"],"sources":["C:/Users/Neerush Buchi/Desktop/Neerush Folder/HMS/frontend/src/pages/BookAppointment.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport api from '../services/api';\r\nimport PaymentForm from './components/PaymentForm';\r\nimport Invoice from './components/Invoice';\r\n\r\n// sensible defaults so the UI works even if the backend endpoint is empty/unavailable\r\nconst DEFAULT_DEPARTMENTS = [\r\n  'General Medicine',\r\n  'Cardiology',\r\n  'Orthopedics',\r\n  'Neurology',\r\n  'Pediatrics',\r\n  'Dermatology',\r\n  'ENT',\r\n  'Gynecology'\r\n];\r\n\r\nconst BookAppointment = () => {\r\n  const { user } = useAuth();\r\n  const navigate = useNavigate();\r\n  \r\n  const [formData, setFormData] = useState({\r\n    department: '',\r\n    doctorId: '',\r\n    date: '',\r\n    time: '',\r\n    purpose: '',\r\n    symptoms: ''\r\n  });\r\n  \r\n  const [departments, setDepartments] = useState(DEFAULT_DEPARTMENTS);\r\n  const [doctors, setDoctors] = useState([]);\r\n  const [availableSlots, setAvailableSlots] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [step, setStep] = useState(1);\r\n  const [selectedDoctor, setSelectedDoctor] = useState(null);\r\n  const [showPayment, setShowPayment] = useState(false);\r\n  const [appointmentId, setAppointmentId] = useState(null);\r\n  const [billId, setBillId] = useState(null);\r\n  const [showInvoice, setShowInvoice] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    fetchDepartments();\r\n  }, [user, navigate]);\r\n\r\n  const fetchDepartments = async () => {\r\n    try {\r\n      // Fetch from the departments collection endpoint\r\n      const response = await api.get('/departments');\r\n      const returned = response?.data?.data?.departments;\r\n      setDepartments(Array.isArray(returned) && returned.length > 0 ? returned.map(d => d.name) : DEFAULT_DEPARTMENTS);\r\n    } catch (error) {\r\n      console.error('Error fetching departments:', error);\r\n      // keep fallback so UI still works\r\n      setDepartments(DEFAULT_DEPARTMENTS);\r\n    }\r\n  };\r\n\r\n  const fetchDoctors = async (department) => {\r\n    try {\r\n      const response = await api.get(`/appointments/doctors/${department}`);\r\n      setDoctors(response.data.data.doctors);\r\n    } catch (error) {\r\n      console.error('Error fetching doctors:', error);\r\n      alert('Error loading doctors');\r\n    }\r\n  };\r\n\r\n  const fetchAvailableSlots = async (doctorId, date) => {\r\n    try {\r\n      const response = await api.get(`/appointments/available-slots/${doctorId}?date=${date}`);\r\n      setAvailableSlots(response.data.data.availableSlots);\r\n    } catch (error) {\r\n      console.error('Error fetching available slots:', error);\r\n      alert('Error loading available time slots');\r\n    }\r\n  };\r\n\r\n  const handleDepartmentChange = (e) => {\r\n    const department = e.target.value;\r\n    setFormData({\r\n      ...formData,\r\n      department,\r\n      doctorId: '',\r\n      date: '',\r\n      time: ''\r\n    });\r\n    setDoctors([]);\r\n    setAvailableSlots([]);\r\n    setSelectedDoctor(null);\r\n    \r\n    if (department) {\r\n      fetchDoctors(department);\r\n      setStep(2);\r\n    } else {\r\n      setStep(1);\r\n    }\r\n  };\r\n\r\n  const handleDoctorChange = (e) => {\r\n    const doctorId = e.target.value;\r\n    const doctor = doctors.find(doc => doc._id === doctorId);\r\n    \r\n    setFormData({\r\n      ...formData,\r\n      doctorId,\r\n      date: '',\r\n      time: ''\r\n    });\r\n    setAvailableSlots([]);\r\n    setSelectedDoctor(doctor);\r\n    \r\n    if (doctorId) {\r\n      setStep(3);\r\n    } else {\r\n      setStep(2);\r\n    }\r\n  };\r\n\r\n  const handleDateChange = (e) => {\r\n    const date = e.target.value;\r\n    setFormData({\r\n      ...formData,\r\n      date,\r\n      time: ''\r\n    });\r\n    setAvailableSlots([]);\r\n    \r\n    if (date && formData.doctorId) {\r\n      fetchAvailableSlots(formData.doctorId, date);\r\n      setStep(4);\r\n    }\r\n  };\r\n\r\n  const handleTimeSelect = (time) => {\r\n    setFormData({\r\n      ...formData,\r\n      time\r\n    });\r\n    setStep(5);\r\n  };\r\n\r\n  const handleInputChange = (e) => {\r\n    setFormData({\r\n      ...formData,\r\n      [e.target.name]: e.target.value\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!formData.doctorId || !formData.date || !formData.time || !formData.purpose) {\r\n      alert('Please fill in all required fields');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    \r\n    try {\r\n      const response = await api.post('/appointments', formData);\r\n      \r\n      if (response.data.status === 'success') {\r\n        setAppointmentId(response.data.data.appointment._id);\r\n        setShowPayment(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error booking appointment:', error);\r\n      alert(error.response?.data?.message || 'Error booking appointment');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handlePaymentComplete = async (paymentDetails) => {\r\n    try {\r\n      // Get the patient ID first\r\n      const patientResponse = await api.get('/patients/me');\r\n      const patientId = patientResponse.data.data.patient._id;\r\n\r\n      // First create the bill\r\n      const billingResponse = await api.post('/billing', {\r\n        appointmentId,\r\n        patient: patientId, // Changed from patientId to patient to match model\r\n        doctorId: formData.doctorId,\r\n        amount: selectedDoctor.consultationFee,\r\n        paymentMode: paymentDetails.method.toUpperCase(),\r\n        paymentStatus: 'Paid',\r\n        paymentDetails: paymentDetails.details\r\n      });\r\n\r\n      if (billingResponse.data.status === 'success') {\r\n        // Then update appointment status\r\n        await api.patch(`/appointments/${appointmentId}`, {\r\n          status: 'Confirmed'\r\n        });\r\n\r\n        setBillId(billingResponse.data.data.bill._id);\r\n        setShowPayment(false);\r\n        setShowInvoice(true);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error processing payment:', error);\r\n      if (error.response?.status === 404) {\r\n        alert('Could not find the appointment. Please try booking again.');\r\n      } else {\r\n        alert('Error processing payment. Please try again.');\r\n      }\r\n      setShowPayment(false);  // Close payment form on error\r\n    }\r\n  };\r\n\r\n  const handleViewInvoice = () => {\r\n    setShowInvoice(true);\r\n  };\r\n\r\n  const handleDownloadInvoice = async () => {\r\n    try {\r\n      const response = await api.get(`/billing/${billId}`);\r\n      const bill = response.data.data.bill;\r\n      // Generate PDF invoice using the bill data\r\n      // You can implement the PDF generation logic here\r\n    } catch (error) {\r\n      console.error('Error downloading invoice:', error);\r\n      alert('Error downloading invoice. Please try again.');\r\n    }\r\n  };\r\n\r\n  const handlePaymentSuccess = () => {\r\n    alert('Payment successful! You can view or download your invoice.');\r\n    navigate('/patient-dashboard');\r\n  };\r\n\r\n  const getMinDate = () => {\r\n    const today = new Date();\r\n    return today.toISOString().split('T')[0];\r\n  };\r\n\r\n  const getMaxDate = () => {\r\n    const maxDate = new Date();\r\n    maxDate.setMonth(maxDate.getMonth() + 2); // 2 months in advance\r\n    return maxDate.toISOString().split('T')[0];\r\n  };\r\n\r\n  if (!user) {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"auth-required\">\r\n          <h2>Authentication Required</h2>\r\n          <p>Please log in to book an appointment.</p>\r\n          <button \r\n            className=\"btn\" \r\n            onClick={() => navigate('/login')}\r\n          >\r\n            Go to Login\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const styles = {\r\n    overlay: {\r\n      position: 'fixed',\r\n      top: 0,\r\n      left: 0,\r\n      right: 0,\r\n      bottom: 0,\r\n      backgroundColor: 'rgba(0, 0, 0, 0.7)',\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      zIndex: 1000\r\n    },\r\n    modal: {\r\n      backgroundColor: '#fff',\r\n      padding: '2rem',\r\n      borderRadius: '8px',\r\n      maxWidth: '600px',\r\n      width: '90%',\r\n      maxHeight: '90vh',\r\n      overflowY: 'auto'\r\n    },\r\n    invoiceActions: {\r\n      display: 'flex',\r\n      gap: '1rem',\r\n      marginBottom: '1rem',\r\n      justifyContent: 'flex-end'\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <div className=\"booking-card\">\r\n        <div className=\"booking-header\">\r\n          <h1><i className=\"fas fa-calendar-plus\"></i> Book Appointment</h1>\r\n          <div className=\"progress-steps\">\r\n            <div className={`step ${step >= 1 ? 'active' : ''}`}>\r\n              <span>1</span>\r\n              <p>Department</p>\r\n            </div>\r\n            <div className={`step ${step >= 2 ? 'active' : ''}`}>\r\n              <span>2</span>\r\n              <p>Doctor</p>\r\n            </div>\r\n            <div className={`step ${step >= 3 ? 'active' : ''}`}>\r\n              <span>3</span>\r\n              <p>Date</p>\r\n            </div>\r\n            <div className={`step ${step >= 4 ? 'active' : ''}`}>\r\n              <span>4</span>\r\n              <p>Time</p>\r\n            </div>\r\n            <div className={`step ${step >= 5 ? 'active' : ''}`}>\r\n              <span>5</span>\r\n              <p>Details</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <form onSubmit={handleSubmit} className=\"appointment-form\">\r\n          {/* Step 1: Department Selection */}\r\n          {step >= 1 && (\r\n            <div className=\"form-section\">\r\n              <h3>Select Department</h3>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"department\">Medical Department *</label>\r\n                <select\r\n                  id=\"department\"\r\n                  name=\"department\"\r\n                  value={formData.department}\r\n                  onChange={handleDepartmentChange}\r\n                  required\r\n                >\r\n                  <option value=\"\">Choose a department</option>\r\n                  {departments.map(dept => (\r\n                    <option key={dept} value={dept}>\r\n                      {dept}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Step 2: Doctor Selection */}\r\n          {step >= 2 && doctors.length > 0 && (\r\n            <div className=\"form-section\">\r\n              <h3>Select Doctor</h3>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"doctor\">Available Doctors *</label>\r\n                <select\r\n                  id=\"doctor\"\r\n                  name=\"doctorId\"\r\n                  value={formData.doctorId}\r\n                  onChange={handleDoctorChange}\r\n                  required\r\n                >\r\n                  <option value=\"\">Choose a doctor</option>\r\n                  {doctors.map(doctor => (\r\n                    <option key={doctor._id} value={doctor._id}>\r\n                      {doctor.name} - {doctor.specialization} ({doctor.consultationFee})\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {selectedDoctor && (\r\n                <div className=\"doctor-info\">\r\n                  <h4>Doctor Information</h4>\r\n                  <p><strong>Name:</strong> {selectedDoctor.name}</p>\r\n                  <p><strong>Specialization:</strong> {selectedDoctor.specialization}</p>\r\n                  <p><strong>Department:</strong> {selectedDoctor.department}</p>\r\n                  <p><strong>Consultation Fee:</strong> {selectedDoctor.consultationFee}</p>\r\n                  <p><strong>Availability:</strong> {selectedDoctor.availability?.days?.join(', ')}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n\r\n          {/* Step 3: Date Selection */}\r\n          {step >= 3 && (\r\n            <div className=\"form-section\">\r\n              <h3>Select Date</h3>\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"date\">Appointment Date *</label>\r\n                <input\r\n                  type=\"date\"\r\n                  id=\"date\"\r\n                  name=\"date\"\r\n                  value={formData.date}\r\n                  onChange={handleDateChange}\r\n                  min={getMinDate()}\r\n                  max={getMaxDate()}\r\n                  required\r\n                />\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Step 4: Time Selection */}\r\n          {step >= 4 && availableSlots.length > 0 && (\r\n            <div className=\"form-section\">\r\n              <h3>Select Time Slot</h3>\r\n              <div className=\"form-group\">\r\n                <label>Available Time Slots *</label>\r\n                <div className=\"time-slots\">\r\n                  {availableSlots.map((slot, index) => (\r\n                    <button\r\n                      key={index}\r\n                      type=\"button\"\r\n                      className={`time-slot ${formData.time === slot.time ? 'selected' : ''} ${\r\n                        !slot.available ? 'disabled' : ''\r\n                      }`}\r\n                      onClick={() => slot.available && handleTimeSelect(slot.time)}\r\n                      disabled={!slot.available}\r\n                    >\r\n                      {slot.time}\r\n                      {!slot.available && <span className=\"slot-status\">Booked</span>}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                {formData.time && (\r\n                  <p className=\"selected-time\">\r\n                    Selected time: <strong>{formData.time}</strong>\r\n                  </p>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Step 5: Appointment Details */}\r\n          {step >= 5 && (\r\n            <div className=\"form-section\">\r\n              <h3>Appointment Details</h3>\r\n              \r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"purpose\">Purpose of Visit *</label>\r\n                <select\r\n                  id=\"purpose\"\r\n                  name=\"purpose\"\r\n                  value={formData.purpose}\r\n                  onChange={handleInputChange}\r\n                  required\r\n                >\r\n                  <option value=\"\">Select purpose</option>\r\n                  <option value=\"Consultation\">General Consultation</option>\r\n                  <option value=\"Follow-up\">Follow-up Visit</option>\r\n                  <option value=\"Checkup\">Routine Checkup</option>\r\n                  <option value=\"Emergency\">Emergency</option>\r\n                  <option value=\"Test Results\">Test Results Discussion</option>\r\n                  <option value=\"Other\">Other</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div className=\"form-group\">\r\n                <label htmlFor=\"symptoms\">Symptoms or Additional Information</label>\r\n                <textarea\r\n                  id=\"symptoms\"\r\n                  name=\"symptoms\"\r\n                  value={formData.symptoms}\r\n                  onChange={handleInputChange}\r\n                  rows=\"4\"\r\n                  placeholder=\"Describe your symptoms or any additional information...\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"appointment-summary\">\r\n                <h4>Appointment Summary</h4>\r\n                <div className=\"summary-details\">\r\n                  <p><strong>Department:</strong> {formData.department}</p>\r\n                  <p><strong>Doctor:</strong> {selectedDoctor?.name}</p>\r\n                  <p><strong>Date:</strong> {new Date(formData.date).toLocaleDateString()}</p>\r\n                  <p><strong>Time:</strong> {formData.time}</p>\r\n                  <p><strong>Purpose:</strong> {formData.purpose}</p>\r\n                  <p><strong>Consultation Fee:</strong> {selectedDoctor?.consultationFee}</p>\r\n                </div>\r\n              </div>\r\n\r\n              <button \r\n                type=\"submit\" \r\n                className=\"btn btn-primary submit-btn\"\r\n                disabled={loading}\r\n              >\r\n                {loading ? (\r\n                  <>\r\n                    <i className=\"fas fa-spinner fa-spin\"></i> Booking Appointment...\r\n                  </>\r\n                ) : (\r\n                  <>\r\n                    <i className=\"fas fa-arrow-right\"></i> Proceed to Payment\r\n                  </>\r\n                )}\r\n              </button>\r\n            </div>\r\n          )}\r\n\r\n          {step < 5 && (\r\n            <div className=\"form-navigation\">\r\n              <p className=\"step-guide\">\r\n                {step === 1 && 'Select a medical department to continue'}\r\n                {step === 2 && 'Choose a doctor from the available specialists'}\r\n                {step === 3 && 'Select your preferred appointment date'}\r\n                {step === 4 && 'Pick an available time slot'}\r\n              </p>\r\n            </div>\r\n          )}\r\n        </form>\r\n      </div>\r\n\r\n      {showPayment && (\r\n        <div style={styles.overlay}>\r\n          <div style={styles.modal}>\r\n            <PaymentForm\r\n              amount={selectedDoctor?.consultationFee}\r\n              onPaymentComplete={handlePaymentComplete}\r\n              onCancel={() => setShowPayment(false)}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {showInvoice && (\r\n        <div style={styles.overlay}>\r\n          <div style={styles.modal}>\r\n            <div style={styles.invoiceActions}>\r\n              <button onClick={handleViewInvoice} className=\"btn btn-primary\">\r\n                <i className=\"fas fa-eye\"></i> View Invoice\r\n              </button>\r\n              <button onClick={handleDownloadInvoice} className=\"btn btn-secondary\">\r\n                <i className=\"fas fa-download\"></i> Download Invoice\r\n              </button>\r\n              <button onClick={handlePaymentSuccess} className=\"btn btn-success\">\r\n                <i className=\"fas fa-check\"></i> Done\r\n              </button>\r\n            </div>\r\n            <Invoice\r\n              billId={billId}\r\n              appointment={{\r\n                doctor: selectedDoctor,\r\n                date: formData.date,\r\n                time: formData.time,\r\n                department: formData.department,\r\n                purpose: formData.purpose\r\n              }}\r\n              patient={user}\r\n              amount={selectedDoctor?.consultationFee}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BookAppointment;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}