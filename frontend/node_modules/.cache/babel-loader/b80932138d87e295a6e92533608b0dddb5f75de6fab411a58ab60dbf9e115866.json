{"ast":null,"code":"import _objectSpread from\"C:/Users/Neerush Buchi/Desktop/Neerush Folder/HMS/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{useAuth}from'../context/AuthContext';import{useNavigate}from'react-router-dom';import api from'../services/api';import{getUpcomingAppointments as getUpcomingFromUtils,getRecentAppointments as getRecentFromUtils}from'../utils/appointmentDateUtils';import Modal from'../components/ui/Modal';import Toast from'../components/ui/Toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const PatientDashboard=()=>{var _patient$contact,_patient$contact2,_formState$contact3,_formState$contact4,_formState$address,_formState$address2,_formState$address3,_formState$address4,_patient$contact3,_patient$contact4;const{user,logout}=useAuth();const navigate=useNavigate();const[patient,setPatient]=useState(null);const[appointments,setAppointments]=useState([]);const[loading,setLoading]=useState(true);const[activeTab,setActiveTab]=useState('overview');const[showCancelModal,setShowCancelModal]=useState(false);const[canceling,setCanceling]=useState(false);const[cancelingAppointmentId,setCancelingAppointmentId]=useState(null);const[toast,setToast]=useState(null);// Profile edit state\nconst[editMode,setEditMode]=useState(false);const[formState,setFormState]=useState(null);const[savingProfile,setSavingProfile]=useState(false);const[avatarPreview,setAvatarPreview]=useState(null);const fileInputRef=useRef(null);const[copySuccess,setCopySuccess]=useState(false);useEffect(()=>{if(!user){navigate('/login');return;}fetchPatientData();fetchAppointments();},[user,navigate]);const fetchPatientData=async()=>{try{const response=await api.get('/patients/profile/me');setPatient(response.data.data.patient);}catch(error){console.error('Error fetching patient data:',error);}};const fetchAppointments=async()=>{try{const response=await api.get('/appointments/my-appointments');setAppointments(response.data.data.appointments);setLoading(false);}catch(error){console.error('Error fetching appointments:',error);setLoading(false);}};const handleLogout=()=>{logout();navigate('/');};const formatDate=dateString=>{return new Date(dateString).toLocaleDateString('en-US',{weekday:'short',year:'numeric',month:'short',day:'numeric'});};// Helper to derive safe display values for appointment/bill fields\nconst getDisplayValues=function(){var _appointment$doctor,_billData$doctor;let appointment=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};let billData=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};const docName=(appointment===null||appointment===void 0?void 0:(_appointment$doctor=appointment.doctor)===null||_appointment$doctor===void 0?void 0:_appointment$doctor.name)||(billData===null||billData===void 0?void 0:(_billData$doctor=billData.doctor)===null||_billData$doctor===void 0?void 0:_billData$doctor.name)||'Doctor';const deptDisplay=(appointment===null||appointment===void 0?void 0:appointment.department)||(billData===null||billData===void 0?void 0:billData.department)||'—';let apptDateDisplay='—';if(appointment!==null&&appointment!==void 0&&appointment.date){const d=new Date(appointment.date);if(!isNaN(d.getTime()))apptDateDisplay=formatDate(appointment.date);}else if(billData!==null&&billData!==void 0&&billData.createdAt){const bd=new Date(billData.createdAt);if(!isNaN(bd.getTime()))apptDateDisplay=bd.toLocaleDateString();}const purposeDisplay=(appointment===null||appointment===void 0?void 0:appointment.purpose)||'Consultation';return{docName,deptDisplay,apptDateDisplay,purposeDisplay};};// Create a Date object that represents the appointment's scheduled datetime\nconst getAppointmentDateTime=appointment=>{// appointment.date is usually an ISO date string (date-only or with time)\n// appointment.time is stored as a string (could be \"HH:MM\" or include AM/PM)\ntry{const datePart=new Date(appointment.date).toISOString().split('T')[0];// Try to construct an ISO-like datetime first (handles \"HH:MM\" or \"HH:MM:SS\")\nlet dt=new Date(\"\".concat(datePart,\"T\").concat(appointment.time));if(!isNaN(dt.getTime()))return dt;// Fallback: try combining with a space (handles formats like \"10:30 AM\")\ndt=new Date(\"\".concat(datePart,\" \").concat(appointment.time));if(!isNaN(dt.getTime()))return dt;// Final fallback: use the date only (midnight)\nreturn new Date(appointment.date);}catch(e){return new Date(appointment.date);}};const getUpcomingAppointments=()=>{const now=new Date();return appointments.map(apt=>_objectSpread(_objectSpread({},apt),{},{_appointmentDateTime:getAppointmentDateTime(apt)})).filter(apt=>apt._appointmentDateTime>now&&apt.status!=='Cancelled').sort((a,b)=>a._appointmentDateTime-b._appointmentDateTime).slice(0,3);};const getRecentAppointments=function(){let limit=arguments.length>0&&arguments[0]!==undefined?arguments[0]:5;const now=new Date();return appointments.map(apt=>_objectSpread(_objectSpread({},apt),{},{_appointmentDateTime:getAppointmentDateTime(apt)})).filter(apt=>apt._appointmentDateTime<=now).sort((a,b)=>b._appointmentDateTime-a._appointmentDateTime).slice(0,limit);};// Cancel appointment (patient action) — sets status to 'Cancelled'\nconst handleCancelAppointment=async appointmentId=>{// Open confirm modal\nsetCancelingAppointmentId(appointmentId);setShowCancelModal(true);};// PROFILE: start editing\nconst startEditProfile=()=>{if(!patient)return;// Deep clone patient to form state\nsetFormState(JSON.parse(JSON.stringify(patient)));setAvatarPreview(null);setEditMode(true);};const cancelEditProfile=()=>{setFormState(null);setAvatarPreview(null);setEditMode(false);};const handleProfileInput=(path,value)=>{setFormState(prev=>{const next=_objectSpread({},prev||{});// support nested paths like 'contact.phone' or 'address.city'\nif(path.includes('.')){const parts=path.split('.');let cur=next;for(let i=0;i<parts.length-1;i++){if(!cur[parts[i]])cur[parts[i]]={};cur=cur[parts[i]];}cur[parts[parts.length-1]]=value;}else{next[path]=value;}return next;});};const handleAvatarChange=e=>{const file=e.target.files&&e.target.files[0];if(!file)return;// preview only — backend does not appear to accept avatars yet\nconst reader=new FileReader();reader.onload=()=>setAvatarPreview(reader.result);reader.readAsDataURL(file);};const handleCopyPatientId=async()=>{if(!(patient!==null&&patient!==void 0&&patient.patientId))return;try{await navigator.clipboard.writeText(patient.patientId);setCopySuccess(true);setTimeout(()=>setCopySuccess(false),2000);}catch(e){console.warn('Copy failed',e);}};const handlePrintProfile=()=>{window.print();};const saveProfile=async()=>{var _formState$contact,_formState$contact2;if(!formState||!patient)return;// basic client-side validation\nif(!formState.fullName||!formState.age||!((_formState$contact=formState.contact)!==null&&_formState$contact!==void 0&&_formState$contact.phone)||!((_formState$contact2=formState.contact)!==null&&_formState$contact2!==void 0&&_formState$contact2.email)){setToast({message:'Please fill required fields: name, age, phone, email',type:'error'});setTimeout(()=>setToast(null),3000);return;}setSavingProfile(true);try{const payload=_objectSpread({},formState);// Remove read-only/system fields\ndelete payload._id;delete payload.user;delete payload.patientId;const response=await api.patch(\"/patients/\".concat(patient._id),payload);const updated=response.data.data.patient;setPatient(updated);setToast({message:'Profile updated successfully',type:'success'});setTimeout(()=>setToast(null),3000);setEditMode(false);setFormState(null);setAvatarPreview(null);}catch(error){var _error$response,_error$response$data;console.error('Error saving profile:',error);setToast({message:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Failed to update profile',type:'error'});setTimeout(()=>setToast(null),3000);}finally{setSavingProfile(false);}};const confirmCancel=async()=>{setShowCancelModal(false);const appointmentId=cancelingAppointmentId;if(!appointmentId)return;setCanceling(true);try{const response=await api.patch(\"/appointments/\".concat(appointmentId),{status:'Cancelled'});const updated=response.data.data.appointment;// Update local state to reflect cancellation\nsetAppointments(prev=>prev.map(a=>a._id===updated._id?_objectSpread(_objectSpread({},a),{},{status:updated.status}):a));// Re-fetch to ensure consistency\nawait fetchAppointments();// Dispatch event to refresh slots\ntry{const doctorId=updated.doctor&&(updated.doctor._id||updated.doctor);const dateISO=updated.date?new Date(updated.date).toISOString().split('T')[0]:null;window.dispatchEvent(new CustomEvent('appointmentCancelled',{detail:{doctorId,date:dateISO,time:updated.time}}));}catch(e){// ignore\n}setToast({message:'Appointment cancelled successfully.',type:'success'});}catch(error){console.error('Error cancelling appointment:',error);setToast({message:'Failed to cancel appointment. Please try again.',type:'error'});}finally{setCanceling(false);setCancelingAppointmentId(null);// clear toast after a short delay\nsetTimeout(()=>setToast(null),3000);}};const getStatusBadgeClass=status=>{switch(status){case'Confirmed':return'status-badge confirmed';case'Pending':return'status-badge pending';case'Completed':return'status-badge completed';case'Cancelled':return'status-badge cancelled';default:return'status-badge pending';}};// Lists used in rendering (cached per render)\nconst upcomingListForRender=getUpcomingFromUtils(appointments,{limit:10});const recentListForRender=getRecentFromUtils(appointments,{limit:50});if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"loading-state\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin fa-2x\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading your dashboard...\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome, \",/*#__PURE__*/_jsx(\"span\",{children:(patient===null||patient===void 0?void 0:patient.fullName)||(user===null||user===void 0?void 0:user.username)})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Here's your health dashboard and upcoming appointments\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn\",onClick:()=>navigate('/book-appointment'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-plus\"}),\" Book Appointment\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline ml-2\",onClick:()=>navigate('/billing'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-invoice-dollar\"}),\" View Bills\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-sections\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"section-btn \".concat(activeTab==='overview'?'active':''),onClick:()=>setActiveTab('overview'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-home\"}),\" Overview\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"section-btn \".concat(activeTab==='appointments'?'active':''),onClick:()=>setActiveTab('appointments'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-alt\"}),\" Appointments\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"section-btn \".concat(activeTab==='profile'?'active':''),onClick:()=>setActiveTab('profile'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user\"}),\" Profile\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-content\",children:[activeTab==='overview'&&/*#__PURE__*/_jsx(\"div\",{className:\"dashboard-section active\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-check\"}),\" Upcoming Appointments\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"appointment-list\",children:getUpcomingAppointments().length>0?getUpcomingAppointments().map(appointment=>{const{docName,deptDisplay,apptDateDisplay,purposeDisplay}=getDisplayValues(appointment);return/*#__PURE__*/_jsxs(\"div\",{className:\"appointment-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"appointment-time\",children:[apptDateDisplay,/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:appointment.time})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"appointment-details\",children:[(_appointment$doctor2=>{const{docName,deptDisplay,apptDateDisplay,purposeDisplay}=getDisplayValues(appointment);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Dr. \",docName]}),/*#__PURE__*/_jsx(\"p\",{children:((_appointment$doctor2=appointment.doctor)===null||_appointment$doctor2===void 0?void 0:_appointment$doctor2.specialization)||deptDisplay}),/*#__PURE__*/_jsx(\"p\",{className:\"appointment-purpose\",children:purposeDisplay})]});})(),/*#__PURE__*/_jsx(\"span\",{className:getStatusBadgeClass(appointment.status),children:appointment.status})]}),/*#__PURE__*/_jsx(\"div\",{className:\"appointment-actions\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"action-stack\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline btn-sm\",children:\"View Details\"}),appointment.status!=='Cancelled'&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm mt-2\",onClick:()=>handleCancelAppointment(appointment._id),disabled:canceling&&cancelingAppointmentId===appointment._id,title:canceling&&cancelingAppointmentId===appointment._id?'Cancelling...':'Cancel Appointment',children:canceling&&cancelingAppointmentId===appointment._id?'Cancelling...':'Cancel'})]})})]},appointment._id);}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-appointments\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-times\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No upcoming appointments\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm\",onClick:()=>navigate('/book-appointment'),children:\"Book Your First Appointment\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-injured\"}),\" Patient Information\"]}),patient&&/*#__PURE__*/_jsxs(\"div\",{className:\"patient-info-details\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Patient ID:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:patient.patientId})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Full Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:patient.fullName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Age:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-value\",children:[patient.age,\" years\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Gender:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:patient.gender})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Blood Group:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:patient.bloodGroup||'Not specified'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Phone:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_patient$contact=patient.contact)===null||_patient$contact===void 0?void 0:_patient$contact.phone})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Email:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"info-value\",children:(_patient$contact2=patient.contact)===null||_patient$contact2===void 0?void 0:_patient$contact2.email})]}),patient.address&&/*#__PURE__*/_jsxs(\"div\",{className:\"info-row\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"info-label\",children:\"Address:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"info-value\",children:[patient.address.street,\", \",patient.address.city,\", \",patient.address.state,\" \",patient.address.zipCode]})]})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline mt-3\",onClick:()=>setActiveTab('profile'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"}),\" Update Profile\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-bolt\"}),\" Quick Actions\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"quick-actions-grid\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"quick-action-btn\",onClick:()=>navigate('/book-appointment'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-plus\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Book Appointment\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"quick-action-btn\",onClick:()=>navigate('/billing'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-file-invoice\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View Bills\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"quick-action-btn\",onClick:()=>setActiveTab('profile'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user-edit\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Update Profile\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:\"quick-action-btn\",onClick:()=>window.print(),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-print\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Print Records\"})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-card\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-history\"}),\" Recent Activity\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"activity-list\",children:getRecentFromUtils(appointments).length>0?getRecentFromUtils(appointments).map(appointment=>/*#__PURE__*/_jsxs(\"div\",{className:\"activity-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"activity-icon\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"activity-content\",children:(()=>{const{docName,deptDisplay,apptDateDisplay,purposeDisplay}=getDisplayValues(appointment);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:purposeDisplay}),\" with Dr. \",docName]}),/*#__PURE__*/_jsxs(\"small\",{children:[apptDateDisplay,\" at \",appointment.time,\" \\u2022\",/*#__PURE__*/_jsx(\"span\",{className:getStatusBadgeClass(appointment.status),children:appointment.status})]})]});})()})]},appointment._id)):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-activity\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-clock\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No recent activity\"})]})})]})]})}),activeTab==='appointments'&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-section active\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Appointments\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn\",onClick:()=>navigate('/book-appointment'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-plus\"}),\" New Appointment\"]})]}),appointments.length>0?/*#__PURE__*/_jsxs(\"div\",{className:\"appointments-table\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Upcoming\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Date & Time\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Doctor\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Purpose\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Actions\"})]}),upcomingListForRender.length>0?upcomingListForRender.map(appointment=>{var _appointment$doctor3;const{docName,deptDisplay,apptDateDisplay,purposeDisplay}=getDisplayValues(appointment);return/*#__PURE__*/_jsxs(\"div\",{className:\"table-row\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:apptDateDisplay}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:appointment.time})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Dr. \",docName]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:((_appointment$doctor3=appointment.doctor)===null||_appointment$doctor3===void 0?void 0:_appointment$doctor3.specialization)||deptDisplay})]})}),/*#__PURE__*/_jsx(\"div\",{children:purposeDisplay||appointment.purpose}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{className:getStatusBadgeClass(appointment.status),children:appointment.status})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-icon\",title:\"View Details\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})}),appointment.status!=='Cancelled'&&/*#__PURE__*/_jsxs(\"button\",{className:\"btn-icon danger\",title:canceling&&cancelingAppointmentId===appointment._id?'Cancelling...':'Cancel Appointment',onClick:()=>handleCancelAppointment(appointment._id),disabled:canceling&&cancelingAppointmentId===appointment._id,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-times\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"span\",{className:\"sr-only\",children:canceling&&cancelingAppointmentId===appointment._id?'Cancelling':'Cancel'})]})]})]},appointment._id);}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-appointments small\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-times fa-2x\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"No upcoming appointments\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You don't have any upcoming appointments scheduled.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm\",onClick:()=>navigate('/book-appointment'),children:\"Book Appointment\"})]}),/*#__PURE__*/_jsx(\"h3\",{children:\"Past / Recent\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"table-header\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Date & Time\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Doctor\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Purpose\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"div\",{children:\"Actions\"})]}),recentListForRender.map(appointment=>{var _appointment$doctor4;const{docName,deptDisplay,apptDateDisplay,purposeDisplay}=getDisplayValues(appointment);return/*#__PURE__*/_jsxs(\"div\",{className:\"table-row\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:apptDateDisplay}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:appointment.time})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"strong\",{children:[\"Dr. \",docName]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"small\",{children:((_appointment$doctor4=appointment.doctor)===null||_appointment$doctor4===void 0?void 0:_appointment$doctor4.specialization)||deptDisplay})]}),/*#__PURE__*/_jsx(\"div\",{children:purposeDisplay||appointment.purpose}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"span\",{className:getStatusBadgeClass(appointment.status),children:appointment.status})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-icon\",title:\"View Details\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-eye\"})})})]},appointment._id);})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-times fa-3x\"}),/*#__PURE__*/_jsx(\"h3\",{children:\"No Appointments Yet\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You haven't booked any appointments yet.\"}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn\",onClick:()=>navigate('/book-appointment'),children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-calendar-plus\"}),\" Book Your First Appointment\"]})]})]}),activeTab==='profile'&&/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-section active\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"My Profile\"}),!editMode?/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-outline\",onClick:startEditProfile,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-edit\"}),\" Edit Profile\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:handleCopyPatientId,title:\"Copy Patient ID\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-copy\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline\",onClick:handlePrintProfile,title:\"Print Profile\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-print\"})})]}):/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:saveProfile,disabled:savingProfile,children:savingProfile?'Saving...':'Save'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline\",onClick:cancelEditProfile,disabled:savingProfile,children:\"Cancel\"})]})]}),patient&&/*#__PURE__*/_jsxs(\"div\",{className:\"profile-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile-header\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"profile-avatar\",children:avatarPreview?/*#__PURE__*/_jsx(\"img\",{src:avatarPreview,alt:\"Avatar preview\",style:{width:56,height:56,borderRadius:'50%'}}):/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-user fa-2x\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-info\",children:[/*#__PURE__*/_jsx(\"h3\",{children:patient.fullName}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Patient ID: \",patient.patientId,\" \",copySuccess&&/*#__PURE__*/_jsx(\"span\",{style:{color:'green',marginLeft:8},children:\"Copied\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Member since \",new Date(patient.createdAt).toLocaleDateString()]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"profile-details\",children:editMode&&formState?/*#__PURE__*/_jsxs(\"div\",{className:\"profile-edit-form\",children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:12,alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"sr-only\",children:\"Upload avatar (preview only)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,onChange:handleAvatarChange,accept:\"image/*\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:formState.fullName}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:12},children:formState.patientId})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Personal Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Full Name\"}),/*#__PURE__*/_jsx(\"input\",{value:formState.fullName||'',onChange:e=>handleProfileInput('fullName',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Age\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:formState.age||'',onChange:e=>handleProfileInput('age',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gender\"}),/*#__PURE__*/_jsxs(\"select\",{value:formState.gender||'',onChange:e=>handleProfileInput('gender',e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Male\",children:\"Male\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Female\",children:\"Female\"}),/*#__PURE__*/_jsx(\"option\",{value:\"Other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Blood Group\"}),/*#__PURE__*/_jsx(\"input\",{value:formState.bloodGroup||'',onChange:e=>handleProfileInput('bloodGroup',e.target.value)})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Contact Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$contact3=formState.contact)===null||_formState$contact3===void 0?void 0:_formState$contact3.email)||'',onChange:e=>handleProfileInput('contact.email',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$contact4=formState.contact)===null||_formState$contact4===void 0?void 0:_formState$contact4.phone)||'',onChange:e=>handleProfileInput('contact.phone',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$address=formState.address)===null||_formState$address===void 0?void 0:_formState$address.street)||'',onChange:e=>handleProfileInput('address.street',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$address2=formState.address)===null||_formState$address2===void 0?void 0:_formState$address2.city)||'',onChange:e=>handleProfileInput('address.city',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$address3=formState.address)===null||_formState$address3===void 0?void 0:_formState$address3.state)||'',onChange:e=>handleProfileInput('address.state',e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"ZIP Code\"}),/*#__PURE__*/_jsx(\"input\",{value:((_formState$address4=formState.address)===null||_formState$address4===void 0?void 0:_formState$address4.zipCode)||'',onChange:e=>handleProfileInput('address.zipCode',e.target.value)})]})]})]})]}):/*#__PURE__*//* Read-only profile */_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Personal Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Full Name\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.fullName})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Age\"}),/*#__PURE__*/_jsxs(\"p\",{children:[patient.age,\" years\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Gender\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.gender})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Blood Group\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.bloodGroup||'Not specified'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Contact Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Email\"}),/*#__PURE__*/_jsx(\"p\",{children:(_patient$contact3=patient.contact)===null||_patient$contact3===void 0?void 0:_patient$contact3.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone\"}),/*#__PURE__*/_jsx(\"p\",{children:(_patient$contact4=patient.contact)===null||_patient$contact4===void 0?void 0:_patient$contact4.phone})]}),patient.address&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.address.street})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"City\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.address.city})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"State\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.address.state})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"ZIP Code\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.address.zipCode})]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-section\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Medical Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"details-grid\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Status\"}),/*#__PURE__*/_jsx(\"p\",{children:patient.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"detail-item\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Last Updated\"}),/*#__PURE__*/_jsx(\"p\",{children:new Date(patient.updatedAt).toLocaleDateString()})]})]})]})]})})]})]})]}),/*#__PURE__*/_jsxs(Modal,{isOpen:showCancelModal,title:\"Cancel Appointment\",onClose:()=>setShowCancelModal(false),children:[/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to cancel this appointment?\"}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:8,marginTop:12},children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline\",onClick:()=>setShowCancelModal(false),children:\"No\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger\",onClick:confirmCancel,disabled:canceling,children:canceling?'Cancelling...':'Yes, Cancel'})]})]}),toast&&/*#__PURE__*/_jsx(Toast,{message:toast.message,type:toast.type})]});};export default PatientDashboard;","map":{"version":3,"names":["React","useState","useEffect","useRef","useAuth","useNavigate","api","getUpcomingAppointments","getUpcomingFromUtils","getRecentAppointments","getRecentFromUtils","Modal","Toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","PatientDashboard","_patient$contact","_patient$contact2","_formState$contact3","_formState$contact4","_formState$address","_formState$address2","_formState$address3","_formState$address4","_patient$contact3","_patient$contact4","user","logout","navigate","patient","setPatient","appointments","setAppointments","loading","setLoading","activeTab","setActiveTab","showCancelModal","setShowCancelModal","canceling","setCanceling","cancelingAppointmentId","setCancelingAppointmentId","toast","setToast","editMode","setEditMode","formState","setFormState","savingProfile","setSavingProfile","avatarPreview","setAvatarPreview","fileInputRef","copySuccess","setCopySuccess","fetchPatientData","fetchAppointments","response","get","data","error","console","handleLogout","formatDate","dateString","Date","toLocaleDateString","weekday","year","month","day","getDisplayValues","_appointment$doctor","_billData$doctor","appointment","arguments","length","undefined","billData","docName","doctor","name","deptDisplay","department","apptDateDisplay","date","d","isNaN","getTime","createdAt","bd","purposeDisplay","purpose","getAppointmentDateTime","datePart","toISOString","split","dt","concat","time","e","now","map","apt","_objectSpread","_appointmentDateTime","filter","status","sort","a","b","slice","limit","handleCancelAppointment","appointmentId","startEditProfile","JSON","parse","stringify","cancelEditProfile","handleProfileInput","path","value","prev","next","includes","parts","cur","i","handleAvatarChange","file","target","files","reader","FileReader","onload","result","readAsDataURL","handleCopyPatientId","patientId","navigator","clipboard","writeText","setTimeout","warn","handlePrintProfile","window","print","saveProfile","_formState$contact","_formState$contact2","fullName","age","contact","phone","email","message","type","payload","_id","patch","updated","_error$response","_error$response$data","confirmCancel","doctorId","dateISO","dispatchEvent","CustomEvent","detail","getStatusBadgeClass","upcomingListForRender","recentListForRender","className","children","username","onClick","_appointment$doctor2","specialization","disabled","title","gender","bloodGroup","address","street","city","state","zipCode","_appointment$doctor3","_appointment$doctor4","style","display","gap","src","alt","width","height","borderRadius","color","marginLeft","alignItems","ref","onChange","accept","fontSize","updatedAt","isOpen","onClose","marginTop"],"sources":["C:/Users/Neerush Buchi/Desktop/Neerush Folder/HMS/frontend/src/pages/PatientDashboard.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport api from '../services/api';\r\nimport {\r\n  getUpcomingAppointments as getUpcomingFromUtils,\r\n  getRecentAppointments as getRecentFromUtils\r\n} from '../utils/appointmentDateUtils';\r\nimport Modal from '../components/ui/Modal';\r\nimport Toast from '../components/ui/Toast';\r\n\r\nconst PatientDashboard = () => {\r\n  const { user, logout } = useAuth();\r\n  const navigate = useNavigate();\r\n  const [patient, setPatient] = useState(null);\r\n  const [appointments, setAppointments] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  const [showCancelModal, setShowCancelModal] = useState(false);\r\n  const [canceling, setCanceling] = useState(false);\r\n  const [cancelingAppointmentId, setCancelingAppointmentId] = useState(null);\r\n  const [toast, setToast] = useState(null);\r\n  // Profile edit state\r\n  const [editMode, setEditMode] = useState(false);\r\n  const [formState, setFormState] = useState(null);\r\n  const [savingProfile, setSavingProfile] = useState(false);\r\n  const [avatarPreview, setAvatarPreview] = useState(null);\r\n  const fileInputRef = useRef(null);\r\n  const [copySuccess, setCopySuccess] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      navigate('/login');\r\n      return;\r\n    }\r\n    fetchPatientData();\r\n    fetchAppointments();\r\n  }, [user, navigate]);\r\n\r\n  const fetchPatientData = async () => {\r\n    try {\r\n      const response = await api.get('/patients/profile/me');\r\n      setPatient(response.data.data.patient);\r\n    } catch (error) {\r\n      console.error('Error fetching patient data:', error);\r\n    }\r\n  };\r\n\r\n  const fetchAppointments = async () => {\r\n    try {\r\n      const response = await api.get('/appointments/my-appointments');\r\n      setAppointments(response.data.data.appointments);\r\n      setLoading(false);\r\n    } catch (error) {\r\n      console.error('Error fetching appointments:', error);\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    logout();\r\n    navigate('/');\r\n  };\r\n\r\n  const formatDate = (dateString) => {\r\n    return new Date(dateString).toLocaleDateString('en-US', {\r\n      weekday: 'short',\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  // Helper to derive safe display values for appointment/bill fields\r\n  const getDisplayValues = (appointment = {}, billData = {}) => {\r\n    const docName = appointment?.doctor?.name || billData?.doctor?.name || 'Doctor';\r\n    const deptDisplay = appointment?.department || billData?.department || '—';\r\n\r\n    let apptDateDisplay = '—';\r\n    if (appointment?.date) {\r\n      const d = new Date(appointment.date);\r\n      if (!isNaN(d.getTime())) apptDateDisplay = formatDate(appointment.date);\r\n    } else if (billData?.createdAt) {\r\n      const bd = new Date(billData.createdAt);\r\n      if (!isNaN(bd.getTime())) apptDateDisplay = bd.toLocaleDateString();\r\n    }\r\n\r\n    const purposeDisplay = appointment?.purpose || 'Consultation';\r\n    return { docName, deptDisplay, apptDateDisplay, purposeDisplay };\r\n  };\r\n\r\n  // Create a Date object that represents the appointment's scheduled datetime\r\n  const getAppointmentDateTime = (appointment) => {\r\n    // appointment.date is usually an ISO date string (date-only or with time)\r\n    // appointment.time is stored as a string (could be \"HH:MM\" or include AM/PM)\r\n    try {\r\n      const datePart = (new Date(appointment.date)).toISOString().split('T')[0];\r\n\r\n      // Try to construct an ISO-like datetime first (handles \"HH:MM\" or \"HH:MM:SS\")\r\n      let dt = new Date(`${datePart}T${appointment.time}`);\r\n      if (!isNaN(dt.getTime())) return dt;\r\n\r\n      // Fallback: try combining with a space (handles formats like \"10:30 AM\")\r\n      dt = new Date(`${datePart} ${appointment.time}`);\r\n      if (!isNaN(dt.getTime())) return dt;\r\n\r\n      // Final fallback: use the date only (midnight)\r\n      return new Date(appointment.date);\r\n    } catch (e) {\r\n      return new Date(appointment.date);\r\n    }\r\n  };\r\n\r\n  const getUpcomingAppointments = () => {\r\n    const now = new Date();\r\n    return appointments\r\n      .map(apt => ({ ...apt, _appointmentDateTime: getAppointmentDateTime(apt) }))\r\n      .filter(apt => apt._appointmentDateTime > now && apt.status !== 'Cancelled')\r\n      .sort((a, b) => a._appointmentDateTime - b._appointmentDateTime)\r\n      .slice(0, 3);\r\n  };\r\n\r\n  const getRecentAppointments = (limit = 5) => {\r\n    const now = new Date();\r\n    return appointments\r\n      .map(apt => ({ ...apt, _appointmentDateTime: getAppointmentDateTime(apt) }))\r\n      .filter(apt => apt._appointmentDateTime <= now)\r\n      .sort((a, b) => b._appointmentDateTime - a._appointmentDateTime)\r\n      .slice(0, limit);\r\n  };\r\n\r\n  // Cancel appointment (patient action) — sets status to 'Cancelled'\r\n  const handleCancelAppointment = async (appointmentId) => {\r\n    // Open confirm modal\r\n    setCancelingAppointmentId(appointmentId);\r\n    setShowCancelModal(true);\r\n  };\r\n\r\n  // PROFILE: start editing\r\n  const startEditProfile = () => {\r\n    if (!patient) return;\r\n    // Deep clone patient to form state\r\n    setFormState(JSON.parse(JSON.stringify(patient)));\r\n    setAvatarPreview(null);\r\n    setEditMode(true);\r\n  };\r\n\r\n  const cancelEditProfile = () => {\r\n    setFormState(null);\r\n    setAvatarPreview(null);\r\n    setEditMode(false);\r\n  };\r\n\r\n  const handleProfileInput = (path, value) => {\r\n    setFormState(prev => {\r\n      const next = { ...(prev || {}) };\r\n      // support nested paths like 'contact.phone' or 'address.city'\r\n      if (path.includes('.')) {\r\n        const parts = path.split('.');\r\n        let cur = next;\r\n        for (let i = 0; i < parts.length - 1; i++) {\r\n          if (!cur[parts[i]]) cur[parts[i]] = {};\r\n          cur = cur[parts[i]];\r\n        }\r\n        cur[parts[parts.length - 1]] = value;\r\n      } else {\r\n        next[path] = value;\r\n      }\r\n      return next;\r\n    });\r\n  };\r\n\r\n  const handleAvatarChange = (e) => {\r\n    const file = e.target.files && e.target.files[0];\r\n    if (!file) return;\r\n    // preview only — backend does not appear to accept avatars yet\r\n    const reader = new FileReader();\r\n    reader.onload = () => setAvatarPreview(reader.result);\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const handleCopyPatientId = async () => {\r\n    if (!patient?.patientId) return;\r\n    try {\r\n      await navigator.clipboard.writeText(patient.patientId);\r\n      setCopySuccess(true);\r\n      setTimeout(() => setCopySuccess(false), 2000);\r\n    } catch (e) {\r\n      console.warn('Copy failed', e);\r\n    }\r\n  };\r\n\r\n  const handlePrintProfile = () => {\r\n    window.print();\r\n  };\r\n\r\n  const saveProfile = async () => {\r\n    if (!formState || !patient) return;\r\n    // basic client-side validation\r\n    if (!formState.fullName || !formState.age || !formState.contact?.phone || !formState.contact?.email) {\r\n      setToast({ message: 'Please fill required fields: name, age, phone, email', type: 'error' });\r\n      setTimeout(() => setToast(null), 3000);\r\n      return;\r\n    }\r\n\r\n    setSavingProfile(true);\r\n    try {\r\n      const payload = { ...formState };\r\n      // Remove read-only/system fields\r\n      delete payload._id;\r\n      delete payload.user;\r\n      delete payload.patientId;\r\n\r\n      const response = await api.patch(`/patients/${patient._id}`, payload);\r\n      const updated = response.data.data.patient;\r\n      setPatient(updated);\r\n      setToast({ message: 'Profile updated successfully', type: 'success' });\r\n      setTimeout(() => setToast(null), 3000);\r\n      setEditMode(false);\r\n      setFormState(null);\r\n      setAvatarPreview(null);\r\n    } catch (error) {\r\n      console.error('Error saving profile:', error);\r\n      setToast({ message: error.response?.data?.message || 'Failed to update profile', type: 'error' });\r\n      setTimeout(() => setToast(null), 3000);\r\n    } finally {\r\n      setSavingProfile(false);\r\n    }\r\n  };\r\n\r\n  const confirmCancel = async () => {\r\n    setShowCancelModal(false);\r\n    const appointmentId = cancelingAppointmentId;\r\n    if (!appointmentId) return;\r\n\r\n    setCanceling(true);\r\n    try {\r\n      const response = await api.patch(`/appointments/${appointmentId}`, { status: 'Cancelled' });\r\n      const updated = response.data.data.appointment;\r\n      // Update local state to reflect cancellation\r\n      setAppointments(prev => prev.map(a => a._id === updated._id ? { ...a, status: updated.status } : a));\r\n      // Re-fetch to ensure consistency\r\n      await fetchAppointments();\r\n\r\n      // Dispatch event to refresh slots\r\n      try {\r\n        const doctorId = updated.doctor && (updated.doctor._id || updated.doctor);\r\n        const dateISO = updated.date ? (new Date(updated.date)).toISOString().split('T')[0] : null;\r\n        window.dispatchEvent(new CustomEvent('appointmentCancelled', { detail: { doctorId, date: dateISO, time: updated.time } }));\r\n      } catch (e) {\r\n        // ignore\r\n      }\r\n\r\n      setToast({ message: 'Appointment cancelled successfully.', type: 'success' });\r\n    } catch (error) {\r\n      console.error('Error cancelling appointment:', error);\r\n      setToast({ message: 'Failed to cancel appointment. Please try again.', type: 'error' });\r\n    } finally {\r\n      setCanceling(false);\r\n      setCancelingAppointmentId(null);\r\n      // clear toast after a short delay\r\n      setTimeout(() => setToast(null), 3000);\r\n    }\r\n  };\r\n\r\n  const getStatusBadgeClass = (status) => {\r\n    switch (status) {\r\n      case 'Confirmed':\r\n        return 'status-badge confirmed';\r\n      case 'Pending':\r\n        return 'status-badge pending';\r\n      case 'Completed':\r\n        return 'status-badge completed';\r\n      case 'Cancelled':\r\n        return 'status-badge cancelled';\r\n      default:\r\n        return 'status-badge pending';\r\n    }\r\n  };\r\n\r\n  // Lists used in rendering (cached per render)\r\n  const upcomingListForRender = getUpcomingFromUtils(appointments, { limit: 10 });\r\n  const recentListForRender = getRecentFromUtils(appointments, { limit: 50 });\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"container\">\r\n        <div className=\"loading-state\">\r\n          <i className=\"fas fa-spinner fa-spin fa-2x\"></i>\r\n          <p>Loading your dashboard...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      {/* Dashboard Header */}\r\n      <div className=\"dashboard-header\">\r\n        <div>\r\n          <h1>Welcome, <span>{patient?.fullName || user?.username}</span></h1>\r\n          <p>Here's your health dashboard and upcoming appointments</p>\r\n        </div>\r\n        <div className=\"dashboard-actions\">\r\n          <button \r\n            className=\"btn\"\r\n            onClick={() => navigate('/book-appointment')}\r\n          >\r\n            <i className=\"fas fa-calendar-plus\"></i> Book Appointment\r\n          </button>\r\n          <button \r\n            className=\"btn btn-outline ml-2\"\r\n            onClick={() => navigate('/billing')}\r\n          >\r\n            <i className=\"fas fa-file-invoice-dollar\"></i> View Bills\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Dashboard Navigation Tabs */}\r\n      <div className=\"dashboard-sections\">\r\n        <button \r\n          className={`section-btn ${activeTab === 'overview' ? 'active' : ''}`}\r\n          onClick={() => setActiveTab('overview')}\r\n        >\r\n          <i className=\"fas fa-home\"></i> Overview\r\n        </button>\r\n        <button \r\n          className={`section-btn ${activeTab === 'appointments' ? 'active' : ''}`}\r\n          onClick={() => setActiveTab('appointments')}\r\n        >\r\n          <i className=\"fas fa-calendar-alt\"></i> Appointments\r\n        </button>\r\n        <button \r\n          className={`section-btn ${activeTab === 'profile' ? 'active' : ''}`}\r\n          onClick={() => setActiveTab('profile')}\r\n        >\r\n          <i className=\"fas fa-user\"></i> Profile\r\n        </button>\r\n      </div>\r\n\r\n      {/* Dashboard Content */}\r\n      <div className=\"dashboard-content\">\r\n        \r\n        {/* Overview Tab */}\r\n        {activeTab === 'overview' && (\r\n          <div className=\"dashboard-section active\">\r\n            <div className=\"dashboard-grid\">\r\n              \r\n              {/* Upcoming Appointments Card */}\r\n              <div className=\"dashboard-card\">\r\n                <h2><i className=\"fas fa-calendar-check\"></i> Upcoming Appointments</h2>\r\n                <div className=\"appointment-list\">\r\n                  {getUpcomingAppointments().length > 0 ? (\r\n                    getUpcomingAppointments().map(appointment => {\r\n                      const { docName, deptDisplay, apptDateDisplay, purposeDisplay } = getDisplayValues(appointment);\r\n                      return (\r\n                        <div key={appointment._id} className=\"appointment-item\">\r\n                        <div className=\"appointment-time\">\r\n                          {apptDateDisplay}\r\n                          <br />\r\n                          <small>{appointment.time}</small>\r\n                        </div>\r\n                        <div className=\"appointment-details\">\r\n                          {(() => {\r\n                            const { docName, deptDisplay, apptDateDisplay, purposeDisplay } = getDisplayValues(appointment);\r\n                            return (\r\n                              <>\r\n                                <h3>Dr. {docName}</h3>\r\n                                <p>{appointment.doctor?.specialization || deptDisplay}</p>\r\n                                <p className=\"appointment-purpose\">{purposeDisplay}</p>\r\n                              </>\r\n                            );\r\n                          })()}\r\n                          <span className={getStatusBadgeClass(appointment.status)}>\r\n                            {appointment.status}\r\n                          </span>\r\n                        </div>\r\n                        <div className=\"appointment-actions\">\r\n                            <div className=\"action-stack\">\r\n                              <button className=\"btn btn-outline btn-sm\">\r\n                                View Details\r\n                              </button>\r\n                              {appointment.status !== 'Cancelled' && (\r\n                                <button\r\n                                  className={`btn btn-danger btn-sm mt-2`} \r\n                                  onClick={() => handleCancelAppointment(appointment._id)}\r\n                                  disabled={canceling && cancelingAppointmentId === appointment._id}\r\n                                  title={canceling && cancelingAppointmentId === appointment._id ? 'Cancelling...' : 'Cancel Appointment'}\r\n                                >\r\n                                  {canceling && cancelingAppointmentId === appointment._id ? 'Cancelling...' : 'Cancel'}\r\n                                </button>\r\n                              )}\r\n                            </div>\r\n                        </div>\r\n                        </div>\r\n                      );\r\n                    })\r\n                  ) : (\r\n                    <div className=\"empty-appointments\">\r\n                      <i className=\"fas fa-calendar-times\"></i>\r\n                      <p>No upcoming appointments</p>\r\n                      <button \r\n                        className=\"btn btn-sm\"\r\n                        onClick={() => navigate('/book-appointment')}\r\n                      >\r\n                        Book Your First Appointment\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Patient Information Card */}\r\n              <div className=\"dashboard-card\">\r\n                <h2><i className=\"fas fa-user-injured\"></i> Patient Information</h2>\r\n                {patient && (\r\n                  <div className=\"patient-info-details\">\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Patient ID:</span>\r\n                      <span className=\"info-value\">{patient.patientId}</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Full Name:</span>\r\n                      <span className=\"info-value\">{patient.fullName}</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Age:</span>\r\n                      <span className=\"info-value\">{patient.age} years</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Gender:</span>\r\n                      <span className=\"info-value\">{patient.gender}</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Blood Group:</span>\r\n                      <span className=\"info-value\">{patient.bloodGroup || 'Not specified'}</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Phone:</span>\r\n                      <span className=\"info-value\">{patient.contact?.phone}</span>\r\n                    </div>\r\n                    <div className=\"info-row\">\r\n                      <span className=\"info-label\">Email:</span>\r\n                      <span className=\"info-value\">{patient.contact?.email}</span>\r\n                    </div>\r\n                    {patient.address && (\r\n                      <div className=\"info-row\">\r\n                        <span className=\"info-label\">Address:</span>\r\n                        <span className=\"info-value\">\r\n                          {patient.address.street}, {patient.address.city}, {patient.address.state} {patient.address.zipCode}\r\n                        </span>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                )}\r\n                <button \r\n                  className=\"btn btn-outline mt-3\"\r\n                  onClick={() => setActiveTab('profile')}\r\n                >\r\n                  <i className=\"fas fa-edit\"></i> Update Profile\r\n                </button>\r\n              </div>\r\n\r\n              {/* Quick Actions Card */}\r\n              <div className=\"dashboard-card\">\r\n                <h2><i className=\"fas fa-bolt\"></i> Quick Actions</h2>\r\n                <div className=\"quick-actions-grid\">\r\n                  <button \r\n                    className=\"quick-action-btn\"\r\n                    onClick={() => navigate('/book-appointment')}\r\n                  >\r\n                    <i className=\"fas fa-calendar-plus\"></i>\r\n                    <span>Book Appointment</span>\r\n                  </button>\r\n                  <button \r\n                    className=\"quick-action-btn\"\r\n                    onClick={() => navigate('/billing')}\r\n                  >\r\n                    <i className=\"fas fa-file-invoice\"></i>\r\n                    <span>View Bills</span>\r\n                  </button>\r\n                  <button \r\n                    className=\"quick-action-btn\"\r\n                    onClick={() => setActiveTab('profile')}\r\n                  >\r\n                    <i className=\"fas fa-user-edit\"></i>\r\n                    <span>Update Profile</span>\r\n                  </button>\r\n                  <button \r\n                    className=\"quick-action-btn\"\r\n                    onClick={() => window.print()}\r\n                  >\r\n                    <i className=\"fas fa-print\"></i>\r\n                    <span>Print Records</span>\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Recent Activity Card */}\r\n              <div className=\"dashboard-card\">\r\n                <h2><i className=\"fas fa-history\"></i> Recent Activity</h2>\r\n                <div className=\"activity-list\">\r\n                  {getRecentFromUtils(appointments).length > 0 ? (\r\n                    getRecentFromUtils(appointments).map(appointment => (\r\n                      <div key={appointment._id} className=\"activity-item\">\r\n                        <div className=\"activity-icon\">\r\n                          <i className=\"fas fa-calendar\"></i>\r\n                        </div>\r\n                        <div className=\"activity-content\">\r\n                          {(() => {\r\n                            const { docName, deptDisplay, apptDateDisplay, purposeDisplay } = getDisplayValues(appointment);\r\n                            return (\r\n                              <>\r\n                                <p>\r\n                                  <strong>{purposeDisplay}</strong> with Dr. {docName}\r\n                                </p>\r\n                                <small>\r\n                                  {apptDateDisplay} at {appointment.time} • \r\n                                  <span className={getStatusBadgeClass(appointment.status)}>\r\n                                    {appointment.status}\r\n                                  </span>\r\n                                </small>\r\n                              </>\r\n                            );\r\n                          })()}\r\n                        </div>\r\n                      </div>\r\n                    ))\r\n                  ) : (\r\n                    <div className=\"empty-activity\">\r\n                      <i className=\"fas fa-clock\"></i>\r\n                      <p>No recent activity</p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Appointments Tab */}\r\n        {activeTab === 'appointments' && (\r\n          <div className=\"dashboard-section active\">\r\n            <div className=\"section-header\">\r\n              <h2>My Appointments</h2>\r\n              <button \r\n                className=\"btn\"\r\n                onClick={() => navigate('/book-appointment')}\r\n              >\r\n                <i className=\"fas fa-plus\"></i> New Appointment\r\n              </button>\r\n            </div>\r\n            \r\n            {appointments.length > 0 ? (\r\n              <div className=\"appointments-table\">\r\n                <h3>Upcoming</h3>\r\n                <div className=\"table-header\">\r\n                  <div>Date & Time</div>\r\n                  <div>Doctor</div>\r\n                  <div>Purpose</div>\r\n                  <div>Status</div>\r\n                  <div>Actions</div>\r\n                </div>\r\n                {upcomingListForRender.length > 0 ? (\r\n                  upcomingListForRender.map(appointment => {\r\n                    const { docName, deptDisplay, apptDateDisplay, purposeDisplay } = getDisplayValues(appointment);\r\n                    return (\r\n                    <div key={appointment._id} className=\"table-row\">\r\n                    <div>\r\n                      <strong>{apptDateDisplay}</strong>\r\n                      <br />\r\n                      <small>{appointment.time}</small>\r\n                    </div>\r\n                    <div>\r\n                      <>\r\n                        <strong>Dr. {docName}</strong>\r\n                        <br />\r\n                        <small>{appointment.doctor?.specialization || deptDisplay}</small>\r\n                      </>\r\n                    </div>\r\n                    <div>{purposeDisplay || appointment.purpose}</div>\r\n                    <div>\r\n                      <span className={getStatusBadgeClass(appointment.status)}>\r\n                        {appointment.status}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <button className=\"btn-icon\" title=\"View Details\">\r\n                        <i className=\"fas fa-eye\"></i>\r\n                      </button>\r\n                      {appointment.status !== 'Cancelled' && (\r\n                        <button\r\n                          className=\"btn-icon danger\"\r\n                          title={canceling && cancelingAppointmentId === appointment._id ? 'Cancelling...' : 'Cancel Appointment'}\r\n                          onClick={() => handleCancelAppointment(appointment._id)}\r\n                          disabled={canceling && cancelingAppointmentId === appointment._id}\r\n                        >\r\n                          <i className=\"fas fa-times\" aria-hidden=\"true\"></i>\r\n                          <span className=\"sr-only\">{canceling && cancelingAppointmentId === appointment._id ? 'Cancelling' : 'Cancel'}</span>\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ); })) : (\r\n                  <div className=\"empty-appointments small\">\r\n                    <i className=\"fas fa-calendar-times fa-2x\"></i>\r\n                    <h4>No upcoming appointments</h4>\r\n                    <p>You don't have any upcoming appointments scheduled.</p>\r\n                    <button className=\"btn btn-sm\" onClick={() => navigate('/book-appointment')}>Book Appointment</button>\r\n                  </div>\r\n                )}\r\n\r\n                <h3>Past / Recent</h3>\r\n                <div className=\"table-header\">\r\n                  <div>Date & Time</div>\r\n                  <div>Doctor</div>\r\n                  <div>Purpose</div>\r\n                  <div>Status</div>\r\n                  <div>Actions</div>\r\n                </div>\r\n                {recentListForRender.map(appointment => {\r\n                  const { docName, deptDisplay, apptDateDisplay, purposeDisplay } = getDisplayValues(appointment);\r\n                  return (\r\n                  <div key={appointment._id} className=\"table-row\">\r\n                    <div>\r\n                      <strong>{apptDateDisplay}</strong>\r\n                      <br />\r\n                      <small>{appointment.time}</small>\r\n                    </div>\r\n                    <div>\r\n                      <strong>Dr. {docName}</strong>\r\n                      <br />\r\n                      <small>{appointment.doctor?.specialization || deptDisplay}</small>\r\n                    </div>\r\n                    <div>{purposeDisplay || appointment.purpose}</div>\r\n                    <div>\r\n                      <span className={getStatusBadgeClass(appointment.status)}>\r\n                        {appointment.status}\r\n                      </span>\r\n                    </div>\r\n                    <div>\r\n                      <button className=\"btn-icon\" title=\"View Details\">\r\n                        <i className=\"fas fa-eye\"></i>\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                  );\r\n                })}\r\n              </div>\r\n            ) : (\r\n              <div className=\"empty-state\">\r\n                <i className=\"fas fa-calendar-times fa-3x\"></i>\r\n                <h3>No Appointments Yet</h3>\r\n                <p>You haven't booked any appointments yet.</p>\r\n                <button \r\n                  className=\"btn\"\r\n                  onClick={() => navigate('/book-appointment')}\r\n                >\r\n                  <i className=\"fas fa-calendar-plus\"></i> Book Your First Appointment\r\n                </button>\r\n              </div>\r\n            )}\r\n\r\n            {/* (Modal and Toast moved to global area below) */}\r\n          </div>\r\n        )}\r\n\r\n        {/* Profile Tab */}\r\n        {activeTab === 'profile' && (\r\n          <div className=\"dashboard-section active\">\r\n              <div className=\"section-header\">\r\n                <h2>My Profile</h2>\r\n                {!editMode ? (\r\n                  <div style={{ display: 'flex', gap: 8 }}>\r\n                    <button className=\"btn btn-outline\" onClick={startEditProfile}>\r\n                      <i className=\"fas fa-edit\"></i> Edit Profile\r\n                    </button>\r\n                    <button className=\"btn\" onClick={handleCopyPatientId} title=\"Copy Patient ID\">\r\n                      <i className=\"fas fa-copy\"></i>\r\n                    </button>\r\n                    <button className=\"btn btn-outline\" onClick={handlePrintProfile} title=\"Print Profile\">\r\n                      <i className=\"fas fa-print\"></i>\r\n                    </button>\r\n                  </div>\r\n                ) : (\r\n                  <div style={{ display: 'flex', gap: 8 }}>\r\n                    <button className=\"btn\" onClick={saveProfile} disabled={savingProfile}>\r\n                      {savingProfile ? 'Saving...' : 'Save'}\r\n                    </button>\r\n                    <button className=\"btn btn-outline\" onClick={cancelEditProfile} disabled={savingProfile}>\r\n                      Cancel\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              {patient && (\r\n                <div className=\"profile-card\">\r\n                  <div className=\"profile-header\">\r\n                    <div className=\"profile-avatar\">\r\n                      {avatarPreview ? (\r\n                        <img src={avatarPreview} alt=\"Avatar preview\" style={{ width: 56, height: 56, borderRadius: '50%' }} />\r\n                      ) : (\r\n                        <i className=\"fas fa-user fa-2x\"></i>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"profile-info\">\r\n                      <h3>{patient.fullName}</h3>\r\n                      <p>Patient ID: {patient.patientId} {copySuccess && <span style={{ color: 'green', marginLeft: 8 }}>Copied</span>}</p>\r\n                      <p>Member since {new Date(patient.createdAt).toLocaleDateString()}</p>\r\n                    </div>\r\n                  </div>\r\n\r\n                  <div className=\"profile-details\">\r\n                    {/* Edit form */}\r\n                    {editMode && formState ? (\r\n                      <div className=\"profile-edit-form\">\r\n                        <div style={{ display: 'flex', gap: 12, alignItems: 'center' }}>\r\n                          <div>\r\n                            <label className=\"sr-only\">Upload avatar (preview only)</label>\r\n                            <input type=\"file\" ref={fileInputRef} onChange={handleAvatarChange} accept=\"image/*\" />\r\n                          </div>\r\n                          <div>\r\n                            <strong>{formState.fullName}</strong>\r\n                            <div style={{ fontSize: 12 }}>{formState.patientId}</div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"detail-section\">\r\n                          <h4>Personal Information</h4>\r\n                          <div className=\"details-grid\">\r\n                            <div className=\"detail-item\">\r\n                              <label>Full Name</label>\r\n                              <input value={formState.fullName || ''} onChange={e => handleProfileInput('fullName', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Age</label>\r\n                              <input type=\"number\" value={formState.age || ''} onChange={e => handleProfileInput('age', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Gender</label>\r\n                              <select value={formState.gender || ''} onChange={e => handleProfileInput('gender', e.target.value)}>\r\n                                <option value=\"\">Select</option>\r\n                                <option value=\"Male\">Male</option>\r\n                                <option value=\"Female\">Female</option>\r\n                                <option value=\"Other\">Other</option>\r\n                              </select>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Blood Group</label>\r\n                              <input value={formState.bloodGroup || ''} onChange={e => handleProfileInput('bloodGroup', e.target.value)} />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"detail-section\">\r\n                          <h4>Contact Information</h4>\r\n                          <div className=\"details-grid\">\r\n                            <div className=\"detail-item\">\r\n                              <label>Email</label>\r\n                              <input value={formState.contact?.email || ''} onChange={e => handleProfileInput('contact.email', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Phone</label>\r\n                              <input value={formState.contact?.phone || ''} onChange={e => handleProfileInput('contact.phone', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Address</label>\r\n                              <input value={formState.address?.street || ''} onChange={e => handleProfileInput('address.street', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>City</label>\r\n                              <input value={formState.address?.city || ''} onChange={e => handleProfileInput('address.city', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>State</label>\r\n                              <input value={formState.address?.state || ''} onChange={e => handleProfileInput('address.state', e.target.value)} />\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>ZIP Code</label>\r\n                              <input value={formState.address?.zipCode || ''} onChange={e => handleProfileInput('address.zipCode', e.target.value)} />\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      /* Read-only profile */\r\n                      <>\r\n                        <div className=\"detail-section\">\r\n                          <h4>Personal Information</h4>\r\n                          <div className=\"details-grid\">\r\n                            <div className=\"detail-item\">\r\n                              <label>Full Name</label>\r\n                              <p>{patient.fullName}</p>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Age</label>\r\n                              <p>{patient.age} years</p>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Gender</label>\r\n                              <p>{patient.gender}</p>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Blood Group</label>\r\n                              <p>{patient.bloodGroup || 'Not specified'}</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"detail-section\">\r\n                          <h4>Contact Information</h4>\r\n                          <div className=\"details-grid\">\r\n                            <div className=\"detail-item\">\r\n                              <label>Email</label>\r\n                              <p>{patient.contact?.email}</p>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Phone</label>\r\n                              <p>{patient.contact?.phone}</p>\r\n                            </div>\r\n                            {patient.address && (\r\n                              <>\r\n                                <div className=\"detail-item\">\r\n                                  <label>Address</label>\r\n                                  <p>{patient.address.street}</p>\r\n                                </div>\r\n                                <div className=\"detail-item\">\r\n                                  <label>City</label>\r\n                                  <p>{patient.address.city}</p>\r\n                                </div>\r\n                                <div className=\"detail-item\">\r\n                                  <label>State</label>\r\n                                  <p>{patient.address.state}</p>\r\n                                </div>\r\n                                <div className=\"detail-item\">\r\n                                  <label>ZIP Code</label>\r\n                                  <p>{patient.address.zipCode}</p>\r\n                                </div>\r\n                              </>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n\r\n                        <div className=\"detail-section\">\r\n                          <h4>Medical Information</h4>\r\n                          <div className=\"details-grid\">\r\n                            <div className=\"detail-item\">\r\n                              <label>Status</label>\r\n                              <p>{patient.status}</p>\r\n                            </div>\r\n                            <div className=\"detail-item\">\r\n                              <label>Last Updated</label>\r\n                              <p>{new Date(patient.updatedAt).toLocaleDateString()}</p>\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              )}\r\n          </div>\r\n        )}\r\n\r\n      </div>\r\n      {/* Global Modal and Toast so they work from any tab */}\r\n      <Modal isOpen={showCancelModal} title=\"Cancel Appointment\" onClose={() => setShowCancelModal(false)}>\r\n        <p>Are you sure you want to cancel this appointment?</p>\r\n        <div style={{ display: 'flex', gap: 8, marginTop: 12 }}>\r\n          <button className=\"btn btn-outline\" onClick={() => setShowCancelModal(false)}>No</button>\r\n          <button className=\"btn btn-danger\" onClick={confirmCancel} disabled={canceling}>\r\n            {canceling ? 'Cancelling...' : 'Yes, Cancel'}\r\n          </button>\r\n        </div>\r\n      </Modal>\r\n\r\n      {/* Toast message */}\r\n      {toast && <Toast message={toast.message} type={toast.type} />}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PatientDashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}